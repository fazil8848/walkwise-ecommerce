<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Footwear - User Profile </title>


    <link id="page_favicon" href="/logo.svg" rel="icon" type="image/x-icon">

    <link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500,600,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Rokkitt:100,300,400,700" rel="stylesheet">

    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

    <!-- Animate.css -->
    <link rel="stylesheet" href="/user/css/animate.css">
    <!-- Icomoon Icon Fonts-->
    <link rel="stylesheet" href="/user/css/icomoon.css">
    <!-- Ion Icon Fonts-->
    <link rel="stylesheet" href="/user/css/ionicons.min.css">
    <!-- Bootstrap  -->
    <link rel="stylesheet" href="/user/css/bootstrap.min.css">

    <!-- Magnific Popup -->
    <link rel="stylesheet" href="/user/css/magnific-popup.css">

    <!-- Flexslider  -->
    <link rel="stylesheet" href="/user/css/flexslider.css">

    <!-- Owl Carousel -->
    <link rel="stylesheet" href="/user/css/owl.carousel.min.css">
    <link rel="stylesheet" href="/user/css/owl.theme.default.min.css">

    <!-- Date Picker -->
    <link rel="stylesheet" href="/user/css/bootstrap-datepicker.css">
    <!-- Flaticons  -->
    <link rel="stylesheet" href="/user/fonts/flaticon/font/flaticon.css">

    <!-- Theme style  -->
    <link rel="stylesheet" href="/user/css/style.css">

    <link rel="stylesheet" href="/user/css/profileStyle.css">

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.22/dist/sweetalert2.all.min.js "></script>

    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.22/dist/sweetalert2.min.css " rel="stylesheet">
</head>

<body>

    <nav class="colorlib-nav" role="navigation">
        <div class="top-menu">
            <div class="container">
                <div class="row">
                    <div class="col-sm-7 col-md-9">
                        <div id="colorlib-logo"><a href="#"> <img style="width: 40px;" src="/logo.svg" alt="">
                                WalkWise</a></div>
                    </div>
                    <div class="col-sm-5 col-md-3">
                        <form action="#" class="search-wrap">
                            <div class="form-group">
                                <input type="search" class="form-control search" placeholder="Search">
                                <button class="btn btn-primary submit-search text-center" type="submit"><i
                                        class="icon-search"></i></button>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12 text-left menu-1">
                        <ul>
                            <li><a href="/home">Home</a></li>
                            <li>
                                <a href="/shop">Shop</a>
                            </li>
                            <li><a href="/about">About</a></li>
                            <li><a href="/contact">Contact</a></li>
                            <li class="cart"><a href="/cart"><i class="icon-shopping-cart"></i> Cart [<%=length%>]</a>
                            <li class="has-dropdown cart  active">
                                <a href="/userProfile"><span class="material-symbols-outlined">account_circle</span></a>
                                <ul class="dropdown">

                                    <% if (typeof req.session.user_id !=='undefined' ) {%>
                                        <li><a href="/userProfile">Profile</a></li>
                                        <li><a href="/viewOrders">Orders</a></li>
                                        <li><a href="/logout">logout</a></li>
                                        <%} else {%>
                                            <li><a href="/login">login</a></li>
                                            <% } %>

                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="sale">
            <div class="container">
                <div class="row">
                    <div class="col-sm-8 offset-sm-2 text-center">
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="row">
            <div class="col-lg-3 my-lg-0 my-md-1">
                <div id="sidebar" class="bg-purple">
                    <div class="h4 text-white">Account</div>
                    <ul>
                        <li class="active">
                            <a href="#" class="text-decoration-none d-flex align-items-start">
                                <div class="fas fa-box pt-2 me-3"></div>
                                <div class="d-flex flex-column">
                                    <div class="link">My Account</div>
                                    <div class="link-desc">View & Manage orders and returns</div>
                                </div>
                            </a>
                        </li>

                        <li>
                            <a href="/addressList" class="text-decoration-none d-flex align-items-start">
                                <div class="far fa-address-book pt-2 me-3"></div>
                                <div class="d-flex flex-column">
                                    <div class="link">Address Book</div>
                                    <div class="link-desc">View & Manage Addresses</div>
                                </div>
                            </a>
                        </li>
                        <li>
                            <a href="/updateProfile" class="text-decoration-none d-flex align-items-start">
                                <div class="far fa-user pt-2 me-3"></div>
                                <div class="d-flex flex-column">
                                    <div class="link">My Profile</div>
                                    <div class="link-desc">Change your profile details & password</div>
                                </div>
                            </a>
                        </li>
                        <li>
                            <a href="#" class="text-decoration-none d-flex align-items-start">
                                <div class="fas fa-headset pt-2 me-3"></div>
                                <div class="d-flex flex-column">
                                    <div class="link">Help & Support</div>
                                    <div class="link-desc">Contact Us for help and support</div>
                                </div>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-lg-9 my-lg-0 my-1">
                <div id="main-content" class="bg-white border">
                    <div class="d-flex flex-column">
                        <div class="h5">
                            <%= user.firstName %>
                                <%= user.lastName %>,
                        </div>
                        <div>Logged in as: <%= user.email %>
                        </div>
                    </div>
                    <a href="/viewOrders">
                        <div class="d-flex my-4 flex-wrap ">
                            <div class="box mr-2 my-1 bg-light p-2">
                                <img src="https://www.freepnglogos.com/uploads/box-png/cardboard-box-brown-vector-graphic-pixabay-2.png"
                                    alt="">
                                <div class="d-flex align-items-center mt-2">
                                    <div class="tag">Orders placed</div>
                                    <div class="ms-auto number">
                                        <%= orderLength %>
                                    </div>
                                </div>
                            </div>
                    </a>
                    <a href="/cart">
                        <div class="box mr-2 my-1 bg-light p-2">
                            <img src="https://www.freepnglogos.com/uploads/shopping-cart-png/shopping-cart-campus-recreation-university-nebraska-lincoln-30.png"
                                alt="">
                            <div class="d-flex align-items-center mt-2">
                                <div class="tag">Items in Cart : </div>
                                <div class="ms-auto number">
                                    <%=length%>
                                </div>
                            </div>
                        </div>
                    </a>
                    <div class="box mr-2 my-1 bg-light p-2">
                        <img src="https://www.freepnglogos.com/uploads/money-png/wallet-money-coins-pictures-png-19.png"
                            alt="">

                        <button type="button" class="btn" data-toggle="modal" data-target="#exampleModalCenter">
                            $<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                class="bi bi-plus" viewBox="0 0 16 16">
                                <path
                                    d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" />
                            </svg>
                        </button>

                        <div class="d-flex align-items-center mt-2">
                            <div class="tag">Wallet: </div>
                            <div class="ms-auto number" style="font-size: 14;">₹ <%= user.wallet %>
                            </div>


                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    </div>


    <footer id="colorlib-footer" role="contentinfo">
        <div class="container">
            <div class="row row-pb-md">
                <div class="col footer-col colorlib-widget">
                    <h4>About Footwear</h4>
                    <p>Even the all-powerful Pointing has no control about the blind texts it is an almost
                        unorthographic life</p>
                    <p>
                    <ul class="colorlib-social-icons">
                        <li><a href="#"><i class="icon-twitter"></i></a></li>
                        <li><a href="#"><i class="icon-facebook"></i></a></li>
                        <li><a href="#"><i class="icon-linkedin"></i></a></li>
                        <li><a href="#"><i class="icon-dribbble"></i></a></li>
                    </ul>
                    </p>
                </div>
                <div class="col footer-col colorlib-widget">
                    <h4>Customer Care</h4>
                    <p>
                    <ul class="colorlib-footer-links">
                        <li><a href="#">Contact</a></li>
                        <li><a href="#">Returns/Exchange</a></li>
                        <li><a href="#">Gift Voucher</a></li>
                        <li><a href="#">Wishlist</a></li>
                        <li><a href="#">Special</a></li>
                        <li><a href="#">Customer Services</a></li>
                        <li><a href="#">Site maps</a></li>
                    </ul>
                    </p>
                </div>
                <div class="col footer-col colorlib-widget">
                    <h4>Information</h4>
                    <p>
                    <ul class="colorlib-footer-links">
                        <li><a href="#">About us</a></li>
                        <li><a href="#">Delivery Information</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">Support</a></li>
                        <li><a href="#">Order Tracking</a></li>
                    </ul>
                    </p>
                </div>

                <div class="col footer-col">
                    <h4>News</h4>
                    <ul class="colorlib-footer-links">
                        <li><a href="blog.html">Blog</a></li>
                        <li><a href="#">Press</a></li>
                        <li><a href="#">Exhibitions</a></li>
                    </ul>
                </div>

                <div class="col footer-col">
                    <h4>Contact Information</h4>
                    <ul class="colorlib-footer-links">
                        <li>291 South 21th Street, <br> Suite 721 New York NY 10016</li>
                        <li><a href="tel://1234567920">+ 1235 2355 98</a></li>
                        <li><a href="mailto:info@yoursite.com">info@yoursite.com</a></li>
                        <li><a href="#">yoursite.com</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="copy">
            <div class="row">
                <div class="col-sm-12 text-center">
                    <p>
                        <span><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                            Copyright &copy;
                            <script>document.write(new Date().getFullYear());</script> All rights reserved | This
                            template is made with <i class="icon-heart" aria-hidden="true"></i> by <a
                                href="https://colorlib.com" target="_blank">Footwear</a>
                            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                        </span>

                    </p>
                </div>
            </div>
        </div>
    </footer>
    </div>


    <!-- Button trigger modal -->


    <!-- Modal -->
    <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog"
        aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <form id="myForm">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLongTitle">Modal title</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">

                        <div class="form-group">
                            <input class="form-control" type="number" name="amount"
                                placeholder="Enter the topup amount.....">
                        </div>

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="submit" id="topup" class="btn btn-primary"> PAY </button>
                    </div>
                </form>
            </div>
        </div>
    </div>


    <div class="gototop js-top">
        <a href="#" class="js-gotop"><i class="ion-ios-arrow-up"></i></a>
    </div>

    <!-- jQuery -->
    <script src="/user/js/jquery.min.js"></script>
    <!-- popper -->
    <script src="/user/js/popper.min.js"></script>
    <!-- bootstrap 4.1 -->
    <script src="/user/js/bootstrap.min.js"></script>
    <!-- jQuery easing -->
    <script src="/user/js/jquery.easing.1.3.js"></script>
    <!-- Waypoints -->
    <script src="/user/js/jquery.waypoints.min.js"></script>
    <!-- Flexslider -->
    <script src="/user/js/jquery.flexslider-min.js"></script>
    <!-- Owl carousel -->
    <script src="/user/js/owl.carousel.min.js"></script>
    <!-- Magnific Popup -->
    <script src="/user/js/jquery.magnific-popup.min.js"></script>
    <script src="/user/js/magnific-popup-options.js"></script>
    <!-- Date Picker -->
    <script src="/user/js/bootstrap-datepicker.js"></script>
    <!-- Stellar Parallax -->
    <script src="/user/js/jquery.stellar.min.js"></script>
    <!-- Main -->
    <script src="/user/js/main.js"></script>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


    <script>
        $(document).ready(() => {
            $('#topup').click(() => {
                const amount = $('#amount').val();
                $.ajax({
                    type: 'POST',
                    url: '/topupWallet',
                    data: {
                        amount,
                    },
                    success: (res) => {
                        if (!res.success) {
                            Swal.fire({
                                icon: 'error',
                                title: 'Oops...',
                                text: 'Minimum topup is 100 !',
                            })
                        } else {
                            razorpay(res.order);
                        }
                    },
                    error: (error) => {
                        console.log(error);
                    }
                })
            })
        })
    </script>

    <script>

        function razorpay(order) {
            var options = {
                "key": "rzp_test_tgKVVDCrIJi46N",
                "amount": order.amount,
                "currency": "INR",
                "name": "WalkWise",
                "description": "Test Transaction",
                "image": "/user/images/logo.jpg",
                "order_id": order.id,
                "handler": function (res) {
                    verifyPayment(res, order);
                },
                "prefill": {
                    "name": "Gaurav Kumar",
                    "email": "gaurav.kumar@example.com",
                    "contact": "9000090000"
                },
                "notes": {
                    "address": "Razorpay Corporate Office"
                },
                "theme": {
                    "color": "#88c8bc"
                }
            };

            var rzp1 = new Razorpay(options);
            rzp1.open();

        }
    </script>

    <script>

        function verifyPayment(payment, order) {

            $.ajax({
                url: '/verifyTopup',
                method: 'post',
                data: {
                    payment,
                    order
                },
                success: (res) => {
                    if (res.success) {
                        console.log('paymnet success');
                        Swal.fire({
                            title: 'PaymentDone',
                            icon: 'success',
                            iconHtml: '؟',
                            confirmButtonText: '<a href="/userProfile">OK</a>',
                            cancelButtonText: '',
                            showCancelButton: true,
                            showCloseButton: false,
                        });

                    } else if (res.onlineSuccess) {

                        Swal.fire({
                            icon: 'error',
                            title: 'Payment has not done',
                            showConfirmButton: false,
                            timer: 1500,
                        });

                    }
                }
            })

        }

    </script>

</body>

</html>